var pushNotification,appInit={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){$("#app-status-ul").append("<li>registering "+device.platform+"</li>"),pushNotification=window.plugins.pushNotification,"android"==device.platform||"Android"==device.platform||"amazon-fireos"==device.platform?($("#app-status-ul").append("<li>Running android push call</li>"),pushNotification.register(appInit.successHandler,appInit.errorHandler,{senderID:"1009597235175",ecb:"appInit.onNotificationGCM"})):($("#app-status-ul").append("<li>Running ios push call</li>"),pushNotification.register(appInit.tokenHandler,appInit.errorHandler,{badge:"true",sound:"true",alert:"true",ecb:"appInit.onNotificationAPN"}))},receivedEvent:function(e){},tokenHandler:function(e){alert("Token Success! Result = "+e),console.log("IOS Token callback Success! Result = "+e),$("#app-status-ul").append("<li>IOS Token callback Success! Result = "+e+"</li>")},successHandler:function(e){console.log("Android Callback Success! Result = "+e),$("#app-status-ul").append("<li>Android Callback Success! Result = "+e+"</li>")},errorHandler:function(e){alert(e)},onNotificationGCM:function(e){function n(e){var n=null;n=new XMLHttpRequest,n.open("GET",e,!0),n.send(null)}switch(e.event){case"registered":e.regid.length>0&&(console.log("Regid "+e.regid),n("http://dev.klapp.se/android-push/add-to-db.php?regID="+e.regid));break;case"message":console.log("message = "+e.message);break;case"error":alert("GCM error = "+e.msg);break;default:alert("An unknown GCM event has occurred")}},onNotificationAPN:function(e){if(e.alert&&navigator.notification.alert(e.alert),e.sound){var n=new Media(e.sound);n.play()}e.badge&&pushNotification.setApplicationIconBadgeNumber(successHandler,errorHandler,e.badge)}};